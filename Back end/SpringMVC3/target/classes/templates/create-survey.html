<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="vi">
    <head>
        <meta charset="UTF-8" />
        <title>T·∫°o kh·∫£o s√°t m·ªõi</title>
    <th:block th:replace="base :: bootstrap"></th:block>
    <script>
        let questionIndex = 0;

        function addQuestion() {
            const container = document.getElementById("question-list");
            const options = ["T·ªët", "Kh√°", "Trung b√¨nh", "K√©m"];

            let optionHtml = options.map((optText, i) => `
        <div>
            <span class="badge bg-secondary px-3 py-2">${optText}</span>
            <input type="hidden" name="questions[${questionIndex}].options[${i}].optionText" value="${optText}" />
        </div>
    `).join('');

            const html = `
        <div class="question-block border rounded p-3 mb-4">
            <div class="d-flex justify-content-between align-items-center mb-2">
                <label class="form-label fw-semibold">C√¢u h·ªèi</label>
                <button type="button" class="btn btn-sm btn-outline-danger" onclick="this.closest('.question-block').remove()">üóëÔ∏è X√≥a</button>
            </div>

            <input type="text" name="questions[${questionIndex}].questionText"
                   class="form-control mb-3" placeholder="Nh·∫≠p n·ªôi dung c√¢u h·ªèi..." required />

            <div class="mb-3">
                <label class="form-label fw-semibold">L·ª±a ch·ªçn tr·∫£ l·ªùi (m·∫∑c ƒë·ªãnh):</label>
                <div class="d-flex gap-3 flex-wrap">
                    ${optionHtml}
                </div>
            </div>
        </div>`;

            container.insertAdjacentHTML("beforeend", html);

            console.log("Added question with index:", questionIndex);  // <-- ki·ªÉm tra ·ªü ƒë√¢y
            questionIndex++;
        }

    </script>
</head>
<body>
    <div th:replace="base :: header"></div>

    <div class="container my-5">
        <h3 class="mb-4">T·∫°o kh·∫£o s√°t m·ªõi</h3>

        <form th:action="@{/admin/survey/create}" method="post">
            <!-- T√™n kh·∫£o s√°t -->
            <div class="mb-4">
                <label class="form-label fw-semibold">T√™n kh·∫£o s√°t</label>
                <input type="text" name="title" class="form-control" placeholder="Nh·∫≠p ti√™u ƒë·ªÅ kh·∫£o s√°t..." required />
            </div>

            <!-- M√¥ t·∫£ kh·∫£o s√°t -->
            <div class="mb-4">
                <label class="form-label fw-semibold">M√¥ t·∫£</label>
                <textarea name="description" class="form-control" rows="3" placeholder="M√¥ t·∫£ ng·∫Øn g·ªçn n·ªôi dung kh·∫£o s√°t..."></textarea>
            </div>

            <!-- Danh s√°ch c√¢u h·ªèi -->
            <div id="question-list"></div>

            <!-- N√∫t th√™m c√¢u h·ªèi -->
            <div class="mb-3">
                <button type="button" class="btn btn-outline-primary" onclick="addQuestion()">‚ûï Th√™m c√¢u h·ªèi</button>
            </div>

            <!-- N√∫t g·ª≠i -->
            <div class="mt-4">
                <button type="submit" class="btn btn-success px-4">T·∫°o kh·∫£o s√°t</button>
                <a th:href="@{/admin/home}" class="btn btn-secondary ms-2">Quay l·∫°i</a>
            </div>
        </form>
    </div>

    <div th:replace="base :: footer"></div>
</body>
</html>
